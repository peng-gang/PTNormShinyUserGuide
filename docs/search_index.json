[["index.html", "User Guide Preface 0.1 General Illustration", " User Guide Gang Peng 2022-02-27 Preface This is a user guide of an online tool for proteomics data normalization and batch effect correction. 0.1 General Illustration Figure 0.1 shows the the general process to run the online tool. Figure 0.1: How to run the tool "],["intro.html", "Chapter 1 Introduction", " Chapter 1 Introduction This is an online tool for proteomics data normalization and batch effect correction. Data normalization and batch effect correction is an important step for proteomics data analysis. There are many methods developed for this process. Here we provided an online tool where users can upload their data and compare the performance of different data normalization and batch effect correction methods. The users can select the best method for their data from the figures of boxplot, coefficient of variation and PCA of the online tool. "],["dataformat.html", "Chapter 2 Input Data Format 2.1 Protein File 2.2 Sample Information File", " Chapter 2 Input Data Format The online tool request two files for input. One file includes abundance for each protein and the other includes sample information in the experiment. 2.1 Protein File The first column of the file is the id for each protein with header “Protein” in the first row. The second column and the following are the abundance of protein for each sample witch a unique column name in the first row. An example protein file is shown in Table 2.1. Table 2.1: Example of first 10 rows of the protein file Protein TR1 FS1 FS2 … MN1 MN2 TR2 A2A432 12946 23552 19797 … 21634 25137 18322 A2A5R2 8421 13330 11759 … 14449 16622 11235 A2A690 8773 13603 11344 … 14952 16806 13155 Q6PDQ2 1007 1761 1348 … 2027 2510 1614 A2ADY9 941 1534 1466 … 1632 1707 1101 A2AG50 83568 149689 126248 … 140182 163669 116929 A2AGT5 113268 216990 174870 … 201874 235820 169570 A2AHC3 7311 15867 12267 … 14200 16059 12361 A2AJA9 1309 2513 1773 … 2242 2604 2323 A2AJI0 20485 39374 30744 … 39205 42535 31750 Please make sure the column name is unique for each column. 2.2 Sample Information File Sample information file contains the experiment design information. It should contain at least two columns: col.name and sample.id for single batch data. The first column is col.name which should be the same as the column names in protein file from the second column. The column sample.id shows the sample id in the experiment. It could be the same as col.name if there is no technical replicate. If there are technical replicates, the technical replicates should have the sample sample.id but different col.name. As shown in Table 2.2, TR1 and TR2 are technical replicates, they have same sample.id TR but different col.name TR1 and TR2. Table 2.2: Sample information file matched for Table 2.1 col.name sample.id TR1 TR FS1 FS1 FS2 FS2 … … MN1 MN1 MN2 MN2 TR2 TR Besides col.name and sample.id, sample information file also accepts the following information as a column in the file: Column Name Description batch Batch effect information. E.g., the first three samples are in batch 1 and the last 3 samples are in batch 2 in Table 2.3 pool Pooling information indicating whether a sample is a pooled sample or not. cv Group information for coefficient of variation (CV) calculation. The samples with same group id in cv column are used for coefficient of variation calculation. Leave the column blank if the sample is not included for the calculation. E.g., P1 and P4 is not included for calculation; FS1 and FS2 are included in CV calculation for group FS; MN3 and MN4 are included in CV calculation for group MN in Table 2.3. If the input data contains multiple batches, a batch column must be included in the sample information file. An example of sample information file with all columns is list in Table 2.3. Table 2.3: Example of sample information file with all columns col.name sample.id batch pool cv P1 pool 1 TRUE FS1 FS1 1 FALSE FS FS2 FS2 1 FALSE FS … … … … … MN3 MN3 2 FALSE MN MN4 MN4 2 FALSE MN P4 pool 2 TRUE Please make sure that the col.name in the sample information file must have the same order as the column name in the protein file. "],["methods.html", "Chapter 3 Methods 3.1 Single Batch 3.2 Multiple Batches", " Chapter 3 Methods If there is only one batch in the input data, the online tool only take the data normalization step. If there are multiple batches in the input data, the online tool normalize the data in each batch first and then take the batch effect correction. Figure 3.1 shows the the general workflow of the tool. Figure 3.1: Workflow of the online tool 3.1 Single Batch If the input data is in a single batch, the online tool only takes the normalization step. The following normalization methods are implemented in the online tool. 3.1.1 Sample Loading This method assumes that the summation of abundance for all the proteins is the same for all the sample. 3.1.2 Median The median normalization is based on the assumption that the median of protein abundance is the sample for all the samples. 3.1.3 Quantile In quantile normalization, the quantile of each sample is replaced by the mean of the same quantile of all the sample (Bolstad et al. 2003). 3.2 Multiple Batches If the input data contains samples from multiple batches, the online tool will take normalization step for each batch first and then remove the batch effect between different batches. Now we have implemented the following batch effect correction methods in the tool. 3.2.1 ComBat We used ComBat method in R package sva. The details of the method can be file in the paper (Johnson, Li, and Rabinovic 2007). 3.2.2 Limma Function removeBatchEffect in R package limma (Ritchie et al. 2015) is used to remove the batch effect. 3.2.3 IRS This method is based on the same pooling sample across different batches. It assumes that the pooling samples have the same protein abundance at different batches and calculates a scaling factor from this assumption. The details of this method can be found at (Plubell et al. 2017). References "],["output.html", "Chapter 4 Output Results 4.1 Boxplot 4.2 Coefficient of Variation (CV) 4.3 Sample Clustering 4.4 How to Choose Normalization and Batch Effect Correction Method 4.5 Download Results", " Chapter 4 Output Results ## Loading required package: limma ## Loading required package: mgcv ## Loading required package: nlme ## Warning: package &#39;nlme&#39; was built under R version 4.1.2 ## This is mgcv 1.8-38. For overview type &#39;help(&quot;mgcv-package&quot;)&#39;. ## Loading required package: genefilter ## Loading required package: BiocParallel The online tool outputs three figures to show the results after data normalization. 4.1 Boxplot The boxplot shows the distribution of protein abundance for each sample. Figure 4.1 shows the boxplot of protein abundance for raw data, after median normalization and after quantile normalization. After data normalization, the distribution of protein abundance for each sample is more similar to each other. Figure 4.1: Boxpolt of protein abundance for each sample in a single batch (before and after normlization) For data from multiple batches, the online tool takes data normalization for each batch first (Figure 4.2). The data within each batch is similar to each other after quantile normalization in each batch. However, samples in batch 1 have higher value than the samples in batch 2. Batch effect correction is necessary before further data analysis. Figure 4.2: Boxplot of protein abundance for ech sample in mulitple batches (before and after normalization without batch effect correction) After ComBat batch effect correction, the difference between the two batches is much smaller (Figure 4.3). ## Found 1 genes with uniform expression within a single batch (all zeros); these will not be adjusted for batch. Figure 4.3: Boxplot of protein abundance for ech sample in mulitple batches (before and after normalization WITH batch effect correction) 4.2 Coefficient of Variation (CV) Coefficient of variation measures the dispersion of data distribution. If a sample has multiple technical replicates, CV between these technical replicates should be small (ideally, CV should be 0). The samples in same situation, e.g. in control group, with same phenotype, should also have relatively small CV. CV of these technical replicates or samples in same situation can be used to check the performance of the data normalization. Users can use cv column in sample information file to set the samples to calculate CV between each other. If column cv is not set, the samples with same sample.id (technical replicates) will be used to calculate CV. If there is no technical replicates and column cv is not set, all samples are used to calculate CV, which may not be a good mark to show the performance of the normalization. Please check Section 2.2 for details. Figure 4.4 shows the CV between two technical replicates of raw data, after median and quantile normalization (example data for single batch). Figure 4.4: CV of technical replicates before and after normalization Figure 4.5 shows the CV in each cv group, which is set in cv column of sample information file (example data for multiple batches). Figure 4.5: CV of samples in same cv group before and after normalization 4.3 Sample Clustering Clustering method can also be used to choose normalization method. After data normalization, the technical replicates or the samples in the same condition should be clustered together (Ritchie et al. 2015). Figure 4.6 shows the clustering result of raw data and the data after quantile normalization in each batch only. The samples in batch 1 are one the left of the figure and the samples in batch 2 are one the right of the figure, which indicates the large difference between the two batches. For the raw data, there is now clear cluster within each batch, while most similar samples in each batch are clustered together after normalization in the batch, e.g. FN1 and FN2. Figure 4.6: Cluster of samples of raw data and after normalization without batch effect correction After both normalization and batch effect correction, the similar samples are clustered together even though they are not in the same batch (Figure 4.7). Figure 4.7: Cluster of samples of raw data and after normalization without batch effect correction 4.4 How to Choose Normalization and Batch Effect Correction Method 4.4.1 Boxplot After normalization and batch effect correction, the boxplot should be similar to each other for all the samples. 4.4.2 Coefficient of Variation (CV) Coefficient of variation between similar or technical replicate samples should be small, especially for technical replicates. 4.4.3 Sample Clustering Similar samples should be clustered together. If there are no close connections between the samples, there should be no cluster groups. 4.5 Download Results After checking the results after data normalization and batch effect correction, user can download the results by click Download Results button on the bottom of figures where users can select the normalization and batch effect correction methods. References "],["references.html", "References", " References "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
